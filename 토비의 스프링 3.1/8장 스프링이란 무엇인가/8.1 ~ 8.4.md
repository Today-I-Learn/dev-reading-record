# 8.1 스프링의 정의

- 스프링은 **자바 엔터프라이즈 개발을 편하게** 해주는 **오픈소스** **경량급** **애플리케이션 프레임워크**이다.

 <br>

## 애플리케이션 프레임워크

- 라이브러리나 프레임워크는 특정 업무 분야나 한 가지 기술에 특화된 목표를 가지고 만들어진다.
- 반면에 애플리케이션 프레임워크는 애플리케이션 전 영역을 포괄하는 범용적인 프레임워크로 애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적인 목표를 두는 프레임워크이다.
- 스프링은 단순히 여러 계층의 다양한 기술을 모아놓았기 때문에 애플리케이션 프레임워크라고 불리는게 아니다.
- 애플리케이션 전 영역을 관통하는 일관된 프로그래밍 모델과 핵심 기술을 바탕으로 해서 각 분야의 특성에 맞는 필요를 채워주고있고 이를 통해 애플리케이션을 빠르고 효과적으로 개발할 수 있기 때문이다.
- 스프링의 일차적인 목적은 핵심 기술에 담긴 프로그래밍 모델을 일관되게 적용해서 엔터프라이즈 애플리케이션 전 계층과 영역에 전략과 기능을 제공해줌으로써 애플리케이션 개발을 편리하게 해주는 애플리케이션 프레임워크로 사용되는 것이다.

 <br>

## 경량급

- 스프링 자체가 가볍다는 이야기가 아니고 EJB와 같은 기술에 비해서 상대적으로 단순하고 가볍다는 이야기이다.
- 스프링은 단순한 서버환경인 톰캣이나 제티에서도 완벽하게 동작하며 단순한 개발툴과 기본적인 개발환경으로도 엔터프라이즈 개발에서 필요한 주요기능을 갖춘 애플리케이션을 개발하는 것이 가능하다.
- 스프링 기반의 코드가 가벼운 이유는 코드에 불필요하게 등장했던 프레임워크와 서버환경에 의존적인 부분을 제거해주어 기술과 환경을 지원하기 위해 반복되던 코드가 제거되고 단순하고 가벼운 코드만 남겨두었기 때문이다.

 <br>

## 자바 엔터프라이즈 개발을 편리하게

 <br>

## 오픈소스

 <br>

# 8.2 스프링의 목적

- 스프링의 개발 철학과 궁극적인 목표가 무엇인지 생각해보자 그리고 스프링을 어떻게 적용하고 사용하는 것이 스프링을 제대로 사용한다고 말할 수 있는 것인지.
- 스프링은 개발 표준이 존재하지 않을 뿐더러 스프링의 베스트 프랙티스만 모아다가 그대로 따른다고 해도 스프링을 잘 사용하고 있다고 확신할 수 없다.
- 스프링은 기능과 API 사용법을 잘 안다고 잘 사용할 수 있는 것이 아니다.
- 자바 언어와 JDK 라이브러리가 일종의 편한 도구로써 객체지향 프로그래밍을 좀 더 손쉽게 할 수 있도록 도와주는 것처럼 자바의 근본적인 목적은 객체지향 프로그래밍을 통해 유연하고 확장성 좋은 애플리케이션을 빠르게 만드는 것이다.
- 때문에 자바를 가지고 절차지향 언어처럼 사용한다면 자바를 사용하는 가치를 얻을 수 없다.
- 스프링은 정의에서 처럼 경량급 프레임워크인 스프링을 활용해서 엔터프라이즈 애플리케이션 개발을 편하게 하는 것이 목적이다.

 <br>

## 8.2.1 엔터프라이즈 개발의 복잡함

- 자바 엔터프라이즈 개발이 실패하는 이유는 여러가지가 있지만 그 중에서 가장 대표적인 이유는 엔터프라이즈 시스템이개발이 너무 복잡해서이기 때문이다.

 <br>

### 엔터프라이즈 애플리케이션은 왜 복잡한가?

- 엔터프라이즈 시스템이란 서버에서 동작하며 기업과 조직의 업무를 처리해주는 시스템을 의미한다.
- 엔터프라이즈 시스템은 많은 사용자의 요청을 동시에 처리해야하기 때문에 서버의 자원을 효율적으로 공유하고 분배해서 사용할 수 있어야 한다.
- 또한 중요한 기업의 핵심 정보나 금융 시스템 등을 다루기도 하기 때문에 보안과 안정성, 확장성 면에서도 뛰어나야 한다.
- 엔터프라이즈 시스템을 개발하는데 순수한 비즈니스 로직을 구현하는 것 이외에도 기술적으로 고려할 사항이 많은데 이러한 기술적인 요구사항은 단순히 고가의 애플리케이션 서버나 툴을 사용한다고 충족되는 것이 아니다.
- 따라서 엔터프라이즈 시스템 개발에는 복잡한 비즈니스 로직과 더불어 기술적인 문제를 고려해야하기 때문에 그 복잡성이 증가하게 된다.
- 결국 비즈니스 로직과 엔터프라이즈 기술이라는 두 가지 복잡함이 한데 얽혀있기 때문에 복잡함이 몇배로 가중되는데 서비스를 개발하기 위해 각종 기술적인 API 호출 코드를 비즈니스 로직에 대한 구현코드와 함께 붙여서 만드는 것은 매우 어렵다.
- 만약 적용한 기술을 변경하거나, 특정 로직을 수정하거나, 하나의 수정 요구를 적용하기 위해 복잡하게 얽혀있는 코드를 헤매다보면 정작 수정해야할 대상이 아닌 부분에 영향을 줘서 새로운 버그를 만들어낼 수 있다.

 <br>

## 8.2.2 복잡함을 해결하려는 도전

- 엔터프라이즈 개발에 나타나는 복잡함의 원인은 제거 대상이 아니며 대신 복잡함을 효과적으로 상대할 수 있는 전략과 기법이 필요하다.
- 따라서 가장 먼저 해야할 일은 성격이 다른 두 가지 복잡함을 분리해내는 일이다.
- EJB도 처음 등장했을 당시에는 이 두 가지 복잡함을 분리하는데 목표를 두었지만 EJB라는 환경과 스팩에 종속되는 코드가 결국에는 자바 언어가 가지는 장점을 잃어버리게 만들었고 결국 객체지향적인 특성을 잃어버리게되었다.
- 반면 스프링은 침투적인 EJB 기술과 반대로 스프링 코드가 직접적으로 애플리케이션에 등장하지 않는 비침투적인 방법을 통해 기술적인 복잡함과 비즈니스 로직을 다루는 코드를 깔끔하게 분리해낼 수 있었다.

 <br>

## 8.2.3 복잡함을 상대하는 스프링의 전략

- 스프링의 기본적인 전략은 비즈니스 로직을 담은 애플리케이션 코드와 엔터프라이즈 기술을 처리하는 코드를 분리시키는 것이다.
- 서비스 추상화 : 기술에 대한 접근 방식의 일관성이 없고 특정 환경에 종속적인 문제를 해결했다.
- AOP : 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장하는 문제를 해결했다.
- 기술적인 코드와 침투적인 기술이 가져온 불필요한 흔적을 제거하고 나면 순수하게 애플리케이션 주요 기능과 비즈니스 로직만 담은 코드만 독립적으로 존재하게 된다.
- 비즈니스 로직의 복잡함은 객체지향 프로그래밍 기법이 주는 유연한 설계와 재사용성을 통해 효과적으로 구현해낼 수 있다.
- 결국 비즈니스 로직의 복잡함을 상대하는 전략은 자바라는 객체지향 기술 그 자체이며 스프링은 단지 객체지향 언어의 장점을 제대로 살리지 못했던 방해요소를 제거하도록 도와줄 뿐이다.

 <br>

### 객체지향과 DI

- 기술과 비즈니스 로직의 복잡함을 해결하는데 스프링이 공통적으로 사용하는 도구는 객체지향이다.
- 때문에 스프링은 자바의 기본인 객체지향에 충실한 설계가 가능하도록 단순한 오브젝트로 개발할 수 있고 객체지향 설계 기법을 잘 적용할 수 있는 구조를 만들기 위해 DI 같은 유용한 기술을 편하게 적용하도록 도와주는 것이 스프링의 전략이다.
- 기술적인 복잡함을 효과적으로 다루게 해주는 기법은 모두 DI를 바탕으로 하고 있는데 서비스 추상화, 템플릿과 콜백, AOP와 같은 스프링 기술은 DI 없이는 존재할 수 없는 것이다.
- DI는 자연스럽게 객체지향 설계와 개발로 이끌어주는 도구이며 성격이다르고 변경의 이유가 다른 후보들을 찾아 DI를 적용해서 오브젝트를 분리하고 인터페이스를 도입하다보면 객체지향 설계원칙의 장점을 잘 살린 설계가 나올 수 있다.
- 기술적인 복잡함을 해결하는 문제나 기술적인 복잡함이 비즈니스 로직에 침범하지 못하도록 분리하는 경우에도 DI가 바탕이된 기법이 활용된다.
- 반면에 비즈니스 로직 자체의 복잡함을 해결하기 위해서는 DI보다는 객체지향 설계 기법이 더 중요하다.

결국 스프링은 비즈니스 로직 자체를 기술적인 코드와 분리해서 순수한 비즈니스 로직만 남겨두어 객체지향 설계에서 나온 도메인 모델을 쉽게 적용할 수 있도록 하였다.

결국 이러한 장점들을 최대한 활용해서 복잡하고 자주 변하는 업무를 지원하는 시스템을 설계할 때에도 손쉽게 대응이 가능해지는 것이며 스프링의 기술과 전략은 객체지향이라는 자바 언어가 가진 강력한 도구를 극대화해서 사용할 수 있도록 돕는 것이라고 볼 수 있다.

 <br>

# 8.3 POJO 프로그래밍

 <br>

## 8.3.2 POJO란 무엇인가?

- POJO는 Plain Old Java Object의 약자로 순수한 자바 객체를 의미한다.
- POJO의 탄생배경은 장난스럽지만 POJO가 지향하고 있는 목적은 단순한 오브젝트를 이용해 애플리케이션 비즈니스 로직을 구현하는 편이 EJB처럼 복잡하고 제한이 많은 기술을 사용하는 것보다 낫다는 것을 어필하기 위해서이다.

 <br>

## 8.3.3 POJO의 조건

- POJO는 다음의 세 가지 조건을 충족해야한다.

 <br>

### 특정 규약에 종속되지 않는다.

- POJO는 자바 언어와 필요한 API 외에는 종속되지 않아야 한다.
- 특정 프레임워크의 규약에 종속되지 않고 객체지향 설계의 자유로운 적용이 가능한 오브젝트여야만 POJO라고 불릴 수 있다.

 <br>

### 특정 환경에 종속되지 않는다.

- 특정 환경에 종속적이어야만 동작하는 오브젝트는 POJO라고 할 수 없다.
- 특히 비즈니스 로직을 담고있는 POJO 클래스는 웹이라는 환경정보나 웹 기술을 담고있는 클래스와 인터페이스를 사용해서는 안된다.
- 때문에 비즈니스 로직을 담은 코드에 `HttpServeletRequest` , `HttpSession` 과 관련된 API가 등장하거나 웹 프레임워크의 클래스를 직접 이용하는 부분이 있다면 진정한 POJO라고 볼 수 없다.

 <br>

### 객체지향 원리에 충실한 설계원칙을 가진다.

- 위의 두가지 조건의 충족되었다고 POJO라고 볼수는 없다.
- 만약 책임과 역할이 다른 코드들을 한 클래스에 몰아넣어 하나의 만능 클래스로 만들고, 재사용이 불가능할 정도로 다른 영역과 레이어에 강한 결합을 가지고 만들어지는 경우, 조건문으로 가득 도배가된 긴 메서드로 작성해 놓은경우라면 객체지향 오브젝트, POJO라고 부르기 힘들다.

때문에 진정한 POJO란 객체지향 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라서 재활용될 수 있는 방식으로 설계된 오브젝트를 의미한다.

또한 그러한 POJO에 애플리케이션의 핵심 로직과 기능을 담아 설계하고 개발하는 방법을 POJO 프로그래밍이라고 한다.

 <br>

## 8.3.4 POJO의 장점은 무엇인가?

- POJO 프로그래밍의 장점은 POJO가 될 수 있는 조건 그자체가 장점이 된다.
- 특정 기술과 환경에 종속되지 않는 오브젝트는 그만큼 깔끔한 코드가 될 수 있다.
- POJO로 개발된 코드는 자동화된 테스트를 작성하는데 매우 유리하다.
- 객체지향 설계를 자유롭게 적용할 수 있다.

 <br>

## 8.3.5 POJO 프레임워크

- 스프링은 POJO를 이용한 엔터프라이즈 애플리케이션 개발을 목적으로 하는 프레임워크라고 한다.
- POJO 프로그래밍이 가능하도록 기술적인 기반을 제공하는 프레임워크를 POJO 프레임워크라고하며 스프링과 하이버네이트가 대표적인 POJO 프레임워크이다.
- 스프링을 이용하면 POJO 프로그래밍의 장점을 그대로 살려서 엔터프라이즈 애플리케이션의 핵심 로직을 객체지향적인 POJO를 기반으로 구현하고 동시에 엔터프라이즈 환경의 각종 서비스와 기술적인 필요를 POJO로 만들어진 코드에 적용할 수 있다.
- 즉, POJO 프레임워크로서 스프링은 자신을 직접 노출하지 않으면서 애플리케이션을 POJO로 개발할 수 있게 지원해준다.

 <br>

# 8.4 스프링의 기술

- 기술과 비즈니스 로직을 분리하고 POJO 방식의 애플리케이션 개발을 가능하게 하기 위해서는 스프링과 같은 POJO 프레임워크가 필요하다.
- 스프링은 POJO 프로그래밍을 손쉽게 할 수 있도록 PSA, IoC/DI, AOP라는 세가지 기술을 제공한다.

 <br>

## 8.4.1 제어의 역전과 의존관계 주입

- 스프링의 가장 기본이 되는 기술이자 스프링의 핵심 개발 원칙이며 AOP와 PSA도 IoC/DI에 바탕을 두고 있다.
- 두 개의 오브젝트를 분리하고 인터페이스를 통해 느슨하게 연결한뒤 실제 사용할 대상은 DI를 통해 외부에서 지정하는 방식이 자신이 사용할 오브젝트를 직접 `new` 키워드로 생성해서 사용하는 강한 결합방법보다 나은점에 대해 생각해보자.
- 가장 간단하게는 유연한 확장이 가능하게 하기 위해서라고 할 수 있는데 DI는 개방 폐쇄 원칙이라는 객체지향 설계 원칙으로 가장 잘 설명될 수 있다.
- 결국 각각의 의존관계를 가지는 두 모듈이 독립적으로 확장이 가능하고 각각의 변경이 다른 모듈에 영향을 주지않고 그대로 유지가 가능하다는 것으로 각각의 관점에서 유연한 확장, 변경없는 재사용으로 해석될 수 있다.

 <br>

### DI의 활용 방법

- 전략패턴을 이용해서 의존 대상이 가진 핵심 기능을 변경하는 경우 즉, 의존 대상의 구현을 변경하는 경우이다.
- 매번 다르게 동적으로 의존 오브젝트의 핵심 기능을 변경하는 경우로 다이나믹 라우팅 프록시나, 프록시 오브젝트 기법을 활용하는 것이다.
- 핵심기능은 그대로 둔 채로 부가기능을 추가하는 것으로 데코레이터 패턴을 생각할 수 있는데 이를 통해 핵심 기능과 클라이언트 코드에 영향을 주지 않으면서 부가적인 기능을 얼마든지 추가할 수 있다.
- 사용하려는 오브젝트가 가진 인터페이스가 클라이언트와 호환되지 않은 경우 어댑터 역할을 해주는 레이어를 추가하여 이를 해결할 수 있으며 DI의 응용방법중 하나이자 PSA가 이 경우의 대표적인 예시이다.
- 프록시 패턴의 전형적인 응용방법인 지연로딩의 경우도 DI를 통해 이루어진다.
- 템플릿과 콜백 패턴에서 콜백을 DI를 이용해서 템플릿에 주입하는 방식으로 유연한 확장과 재사용이 가능한 코드를 만들 수 있다.
- DI가 필요한 이유 중 한가지는 DI할 오브젝트의 생명주기를 제어할 수 있다는 것인데 이를 통해 오브젝트의 생성, 관계설정, 이용, 소멸에 이르기까지의 모든 과정을 DI 컨테이너가 주관하기 때문에 오브젝트의 스코프를 자유롭게 제어할 수 있다.
- 테스트에 DI를 적용하면 고립된 단위 테스트를 쉽게 만들 수 있다.

 <br>

## 8.4.2 AOP

- 객체지향 기술만으로 점점 복잡해져가는 애플리케이션 요구조건과 기술적인 난해함을 모두 해결하는데에는 한계가 있다.
- AOP는 이러한 객체지향의 한계와 단점을 극복하도록 도와주는 보조적인 프로그래밍 도구로써 AOP를 통해 OOP를 더욱 OOP 답게 만들 수 있다.
- 때문에 스프링의 목적인 POJO만으로 엔터프라이즈 애플리케이션을 개발하면서 엔터프라이즈 서비스를 선언적으로 제공하는데 필요한 것이 AOP 기술이다.

 <br>

### 다이나믹 프록시를 이용한 AOP 적용

- 스프링과 같이 다이나믹 프록시를 이용하는 방법으로 기존의 코드에 영향을 주지 않고 부가기능을 적용하게 해주는 데코레이터 패턴을 응용할 수 있다.
- 하지만 인터페이스와 DI를 활용하는 데코레이터 패턴을 기반원리로 한 만큼 부가 기능을 부여할 수 있는 곳은 메서드의 호출이 일어나는 지점 뿐이라는 제약이 존재한다.

 <br>

### AspectJ와 같은 자바 언어의 한계를 뛰어넘는 언어의 확장을 이용해서 AOP를 적용

- AspectJ는 강력한 기능을 가진 AOP를 제공하며 프록시 방식의 AOP에서는 불가능한 다양한 조인 포인트를 제공한다.
- 메서드 호출 뿐만아니라 인스턴스 생성, 필드 엑세스, 특정 호출 경로를 가진 메서드의 호출 등에도 부가기능을 제공할 수 있다.
- 이러한 AOP를 적용하기 위해서는 단순히 자바 언어와 JDK의 지원만으로는 불가능하며 별도의 AOP 컴파일러를 이용한 빌드 과정을 거치거나 바이트 코드를 조작하는 위빙과 같은 별도의 방법을 이용해야 한다.

 <br>

## 8.4.3 PSA

- 서비스 추상화는 특정 기술과 환경의 변화에 관계없이 일관된 방식으로 기술에 접근할 수 있게 해주는 기술이다.
- POJO로 개발된 코드는 특정 환경이나 구현 방식에 종속되지 않아야하며 스프링은 PSA를 통해 POJO가 자바 엔터프라이즈 환경에 기술에 직접적으로 노출되지 않도록 해준다.
